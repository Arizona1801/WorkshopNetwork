<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>titre</title>    
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Equipe sabotage</h1>
            <p class="subtitle">Secoue ton téléphone pour siphonner l’essence de la fusée</p>
        </div>
        
        <img class="secouepng" src="secoue.png" alt="rocket" />

        <div class="buttonContent">
            <div class="buttonBorder">
                <img class="borderSvg" src="border.svg" alt="">
                <button class="buttonBonus">Bonus</button>
            </div>
            <p class="subButton">Progression x2</p>
        </div>

        <p class="bottomText">Secoue!</p>


    </div>
        
    <script>
        let fill = 0; // Progression initiale
        let lastShake = 0; // Dernière secousse détectée
        const buttonBonus = document.querySelector('.buttonBonus');

        // Met à jour le remplissage du bouton
        function updateButtonFill() {
            buttonBonus.style.background = `linear-gradient(to top, var(--green) ${fill}%, #bbbec2 ${fill}%)`;
            if (fill >= 100) {
                buttonBonus.textContent = 'Cliquez !';
                buttonBonus.disabled = false;
            } else {
                buttonBonus.textContent = 'Bonus';
                buttonBonus.disabled = true;
            }
        }

        // Gère la détection des secousses
        function handleShake(event) {
            const acc = event.accelerationIncludingGravity;
            if (!acc) {
                console.error('Les données de mouvement ne sont pas disponibles.');
                return;
            }
            const totalAcc = Math.sqrt(acc.x ** 2 + acc.y ** 2 + acc.z ** 2);

            const now = Date.now();
            if (totalAcc > 15 && now - lastShake > 500) {
                lastShake = now;
                fill = Math.min(100, fill + 10);
                updateButtonFill();
            }
        }

        // Vide la jauge lorsque le bouton est cliqué
        buttonBonus.addEventListener('click', () => {
            if (fill >= 100) {
                fill = 0;
                updateButtonFill();
                alert('Jauge vidée, bonus activé !');
            }
        });

        // Demande la permission dès que la page est chargée
        window.addEventListener('devicemotion', handleShake);

    </script>
</body>
</html>
